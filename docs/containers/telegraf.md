# Telegraf

Telegraf consumes the CAN metrics generated by the startup data loader and forwards them to InfluxDB 3 using line protocol.

## Responsibilities

- Watches `/var/lib/telegraf/can_metrics.out` for new line protocol files generated by the importer.
- Writes data to the `WFR25` bucket in InfluxDB 3.

## Configuration

| Variable | Description | Default |
| --- | --- | --- |
| `INFLUXDB_URL` | Target database URL. | `http://influxdb3:8181` |
| `INFLUXDB_TOKEN` | Token with write access to the target bucket. | `dev-influxdb-admin-token` |

The configuration file lives at `installer/telegraf.conf` and supports environment variable substitution for the URL and token.

## Debugging tips

- Tail Telegraf logs: `docker compose logs -f telegraf`.
- Inspect generated line protocol: `docker compose exec telegraf tail -f /var/lib/telegraf/can_metrics.out`.
- Validate that the token grants write access by running `docker compose exec telegraf env | grep INFLUXDB`.
